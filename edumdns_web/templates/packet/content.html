<div class="max-w-7xl mx-auto mb-10 md:mb-5">
    <!-- Header Section -->
    <div class="flex flex-col justify-center items-center py-6">
        <h2 class="text-4xl font-bold text-sat-xl">Packets</h2>
    </div>

    <div class="max-w-7xl overflow-x-auto rounded-lg border border-base bg-cards">
        <table class="w-full divide-y divide-base">
            <thead class="bg-muted/10">
            <tr>
                <th scope="col"
                    class="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-sat-l text-muted-foreground">
                    ID
                </th>
                <th scope="col"
                    class="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-sat-l text-muted-foreground">
                    Probe
                </th>
                <th scope="col"
                    class="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-sat-l text-muted-foreground">
                    Source MAC
                </th>
                <th scope="col"
                    class="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-sat-l text-muted-foreground">
                    Destination MAC
                </th>
                <th scope="col"
                    class="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-sat-l text-muted-foreground">
                    Source
                </th>
                <th scope="col"
                    class="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-sat-l text-muted-foreground">
                    Destination
                </th>
                <th scope="col"
                    class="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-sat-l text-muted-foreground">
                    Actions
                </th>
            </tr>
            </thead>
            <tbody class="divide-y divide-base">
            {% for packet in packets %}
            <tr class="hover:bg-muted/5 transition-colors">
                <td class="px-4 py-3 font-mono text-sm">
                    <a href="/packet/{{ packet.id }}" class="text-primary hover:underline">
                        {{ packet.id }}
                    </a>
                </td>
                <td class="px-4 py-3 font-mono text-sm">
                    <a href="/probe/{{ packet.probe_id }}" class="text-primary hover:underline">
                        {{ packet.probe_id }}
                    </a>
                </td>

                <td class="px-4 py-3 text-sm text-sat-l font-mono">{{ packet.src_mac }}</td>
                <td class="px-4 py-3 text-sm text-sat-l font-mono">{{ packet.dst_mac }}</td>
                <td class="px-4 py-3 text-sm text-sat-l">
                    <span class="font-mono">{{ packet.src_addr }}</span><span
                        class="text-muted-foreground">:</span><span class="font-mono">{{ packet.src_port }}</span>
                </td>
                <td class="px-4 py-3 text-sm text-sat-l">
                    <span class="font-mono">{{ packet.dst_addr }}</span><span
                        class="text-muted-foreground">:</span><span class="font-mono">{{ packet.dst_port }}</span>
                </td>
                {% if permissions|has_perm("Delete") %}
                <td class="px-4 py-3 text-sm text-sat-l">
                    <button
                            hx-delete="/packet/{{ packet.id }}/delete?return_url=/packet?page={{ page_info.page }}"
                            hx-target="#content-area"
                            hx-target-error="#content-area"
                            hx-push-url="/packet?page={{ page }}"
                            class="inline-flex items-center rounded-md border border-base px-3 py-1 text-sm text-red-400 hover:bg-muted/20 transition-colors"
                            title="Delete Packet"

                    >
                        <i class="fa-solid fa-trash"></i>
                    </button>
                </td>
                {% endif %}
            </tr>
            {% endfor %}
            </tbody>
        </table>

        {% if packets|length == 0 %}
        <div class="p-6 text-center text-muted-foreground">
            No packets found.
        </div>
        {% endif %}
    </div>

    {% if page_info.total_pages > 1 %}
    <div class="flex justify-center items-center mt-6 space-x-2">
        {# Previous button #}
        {% if page_info.page > 1 %}
        <a href="/packet?page={{ page_info.page - 1 }}"
           class="px-3 py-1 rounded-md border border-base text-sm hover:bg-muted/20 transition-colors">
            Prev
        </a>
        {% endif %}

        {# Display the first page #}
        {% if page_info.page > 4 %}
        <a href="/packet?page=1"
           class="px-3 py-1 rounded-md border border-base text-sm hover:bg-muted/20 transition-colors">
            1
        </a>
        {% endif %}

        {# Display the '...' if needed #}
        {% if page_info.page > 4 %}
        <span class="px-3 py-1 rounded-md border border-base text-sm">...</span>
        {% endif %}

        {# Numbered pages #}
        {% for p in [page_info.page - 2, page_info.page - 1, page_info.page, page_info.page + 1, page_info.page + 2] %}
        {% if 1 <= p and p <= page_info.total_pages %}
        {% if p == page_info.page %}
        <span class="px-3 py-1 rounded-md bg-primary text-white text-sm">{{ p }}</span>
        {% else %}
        <a href="/packet?page={{ p }}"
           class="px-3 py-1 rounded-md border border-base text-sm hover:bg-muted/20 transition-colors">
            {{ p }}
        </a>
        {% endif %}
        {% endif %}
        {% endfor %}

        {# Display the '...' if needed #}
        {% if page_info.page < page_info.total_pages - 3 %}
        <span class="px-3 py-1 rounded-md border border-base text-sm">...</span>
        {% endif %}

        {# Display the last page #}
        {% if page_info.page < page_info.total_pages - 2 %}
        <a href="/packet?page={{ page_info.total_pages }}"
           class="px-3 py-1 rounded-md border border-base text-sm hover:bg-muted/20 transition-colors">
            {{ page_info.total_pages }}
        </a>
        {% endif %}

        {# Next button #}
        {% if page_info.page < page_info.total_pages %}
        <a href="/packet?page={{ page_info.page + 1 }}"
           class="px-3 py-1 rounded-md border border-base text-sm hover:bg-muted/20 transition-colors">
            Next
        </a>
        {% endif %}
    </div>
    {% endif %}


</div>
